
day <- c(1,2,3,4,5,6,1,2,3,4,5,6)
micro <- c("open","open","open","open","open","open","shrub","shrub","shrub","shrub","shrub","shrub")
temp.avg<- c(32.948175,12.5,30.43798333,30.09579167,25.10313333,24.93531579,33.069475,29.02473333,29.83319167,29.68969167,24.97499167,24.93110526)
RH.avg<- c(15.14114063,28.23341667,20.33464583,22.839625,18.9189375,12.43319737,15.252,18.74651042,21.391625,23.63940625,19.346375,12.17963158)
temp.se<- c(2.554883762,1.443375673,2.357783576,2.122814007,1.662778904,2.107292906,2.838637402,2.402243768,2.704197854,2.429822781,1.954581323,2.434770875)
RH.se<- c(0.961615404,2.72052896,1.853840155,1.774854189,3.154404301,0.699100019,1.253223117,1.258215343,2.196627828,2.033246213,3.471244276,0.797876303)
richness<- c(3.533333333,3.666666667,3.6,3.129032258,4.633333333,5.4,6.033333333,6.333333333,7.833333333,7.833333333,10.5,15.4)
abundance<- c(5.033333333,5.133333333,4.3,4.4,4.6,6.266666667,9.233333333,8.8,7.166666667,11.35,15.03333333,11.1)
richness.se<- c(0.344858236,0.329867035,0.286075306,0.315319716,0.260341656,0.457127,0.721561737,0.578013509,0.719328124,0.756714271,1.088867386,0.469531)
abundance.se<- c(0.344023968,0.331257907,0.352821143,0.398383832,0.337672902,1.769083,1.140360231,0.75109116,0.612294222,1.0887499,2.545677076,1.014294)

error.bar <- function(x, y, upper, lower=upper, length=0.1,...){
if(length(x) != length(y) | length(y) !=length(lower) | length(lower) != length(upper))
stop("vectors must be same length")
arrows(x,y+upper, x, y-lower, angle=90, code=3, length=length, ...)
}


m1 <- t.test(temp.avg~micro)
m2 <- t.test(RH.avg~micro)
m3 <- t.test(richness~micro)
m4 <- t.test(abundance~micro)

plot(RH.avg,richness)
m1 <- lm(abundance~RH.avg)

data2 <- data.frame(day,micro,temp.avg,RH.avg,richness,abundance, temp.se, RH.se, richness.se,abundance.se)

shrubs <- subset(data2, micro=="shrub")
opens <- subset(data2, micro=="open")

plot(shrubs$RH.avg,shrubs$richness)

m1 <- lm(abundance~temp.avg, data=shrubs)
m2 <- lm(richness~temp.avg, data=shrubs)## sig

m3 <- lm(abundance~temp.avg, data=opens)
m4 <- lm(richness~temp.avg, data=opens) 


m1 <- lm(abundance~RH.avg, data=shrubs)
m2 <- lm(richness~RH.avg, data=shrubs)

m3 <- lm(abundance~RH.avg, data=opens)
m4 <- lm(richness~RH.avg, data=opens)



par(mfrow=c(1,2))
par(mar=c(4.5,4.5,.5,.5))
plot(shrubs$temp.avg,shrubs$abundance, pch=19, cex=2, cex.axis=1.5, cex.lab=1.8, xlab="Daily Temperature", ylab="Insect Abundance", ylim=c(4,18))
error.bar(shrubs$temp.avg,shrubs$abundance,shrubs$abundance.se, lwd=2)
error.bar(opens$temp.avg,opens$abundance,opens$abundance.se, lwd=2)
points(opens$temp.avg,opens$abundance, cex=2, pch=21, bg="White")



par(mar=c(4.5,4.5,.5,.5))
plot(shrubs$temp.avg,shrubs$richness, pch=19, cex=2, cex.axis=1.5, cex.lab=1.8, xlab="Daily Temperature", ylab="Insect richness", ylim=c(2,18))
error.bar(shrubs$temp.avg,shrubs$richness,shrubs$richness.se, lwd=2)
error.bar(opens$temp.avg,opens$richness,opens$richness.se, lwd=2)
points(opens$temp.avg,opens$richness, cex=2, pch=21, bg="White")
abline(m2, lwd=3, lty=2)



par(mfrow=c(1,2))
par(mar=c(4.5,4.5,.5,.5))
plot(shrubs$RH.avg,shrubs$abundance, pch=19, cex=2, cex.axis=1.5, cex.lab=1.8, xlab="Daily Relative Humidity", ylab="Insect Abundance", ylim=c(4,18))
error.bar(shrubs$RH.avg,shrubs$abundance,shrubs$abundance.se, lwd=2)
error.bar(opens$RH.avg,opens$abundance,opens$abundance.se, lwd=2)
points(opens$RH.avg,opens$abundance, cex=2, pch=21, bg="White")



par(mar=c(4.5,4.5,.5,.5))
plot(shrubs$RH.avg,shrubs$richness, pch=19, cex=2, cex.axis=1.5, cex.lab=1.8, xlab="Daily Relative Humidity", ylab="Insect richness", ylim=c(2,18))
error.bar(shrubs$RH.avg,shrubs$richness,shrubs$richness.se, lwd=2)
error.bar(opens$RH.avg,opens$richness,opens$richness.se, lwd=2)
points(opens$RH.avg,opens$richness, cex=2, pch=21, bg="White")


## line plots

day<-c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6)
time<-c(9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19)
Shrub.temp<-c(31.6064,38.9234,43.9194,46.9744,44.6074,42.4534,41.4252,38.1416,36.9828,33.347,28.8578,22.8648,20.2414,19.6604,19.3748,17.7906,16.0522,15.5942,15.843,15.3274,15.3034,15.3276,19.5234,27.785,35.043,40.8606,44.8942,48.2898,45.5554,44.2742,43.2314,39.7734,38.3426,35.0114,30.5784,24.4816,23.1036,21.7964,20.1936,20.4078,19.7268,18.847,18.0954,16.9392,15.9664,14.1536,20.4914,29.0392,35.6152,41.5722,45.9404,49.4014,47.0088,45.5256,44.1192,41.0324,39.6872,36.1142,32.054,27.099,23.7196,24.1518,23.1364,21.0752,19.7078,18.823,18.0952,17.4674,16.2816,16.2962,20.7712,29.6216,36.0058,40.6666,43.6854,45.9694,44.6148,42.8792,42.5824,39.8686,38.608,34.7058,31.6534,28.6178,26.4614,24.886,23.103,20.9274,18.9896,18.2,16.939,16.181,14.925,16.4632,20.1896,25.0796,30.0472,34.1656,35.8664,37.8618,37.4406,35.9988,35.0092,32.4932,31.5302,28.0924,24.5158,21.539,16.8436,19.0418,18.1332,16.9294,15.7136,14.9972,14.4036,14.0778,13.304,12.754,16.1032,22.9342,26.6886,29.3322,34.2954,39.055,37.206,35.3872,34.7684,31.382,30.1038,27.2592,24.0056)
Open.temp<-c(28.4746,35.7834,40.4218,43.98,46.0166,46.2738,46.0476,43.4724,40.0502,35.4734,29.1416,22.5868,19.5082,18.3616,17.6578,15.8618,13.996,13.5548,13.8144,13.3096,13.3388,13.2712,14.9964,22.4828,30.141,36.0922,40.9482,44.93,47.1448,48.215,48.4178,46.1676,42.5756,37.7656,31.2228,24.7878,22.5094,20.3792,18.7752,18.7658,18.024,16.9962,16.2818,15.079,14.1026,12.4502,15.7558,23.5834,31.033,37.625,42.5424,46.6304,49.2972,50.294,49.7856,47.2656,43.5086,38.6308,32.574,26.8162,23.1334,23.0454,21.9198,19.6222,18.2664,17.3152,16.4676,15.8192,14.4952,14.5002,17.2056,24.9186,31.6798,36.9478,40.873,44.7062,46.801,47.3438,47.3694,44.9064,42.5238,36.7282,32.2902,28.6532,26.0958,24.2918,22.4272,19.927,17.8716,16.9912,15.671,14.8684,13.5586,14.9548,17.1814,21.9774,27.0354,31.3326,33.9136,36.8604,39.4418,39.7824,40.1012,38.3612,35.0458,30.322,24.901,21.32,15.8834,18.3282,17.4864,16.21,14.897,14.2124,13.6028,13.2806,12.5136,11.9182,12.6638,19.037,23.7046,26.8598,31.7004,36.2876,38.3696,38.8426,39.303,37.91,34.2052,29.8036,24.5792)
Shrub.RH<-c(22.76475,18.449,15.1675,13.57825,12.1605,10.692,10.52975,10.9625,11.1125,12.01225,13.6055,16.29175,18.09225,18.43975,18.576,19.824,21.565,21.92975,23.64325,25.2505,29.03225,32.3265,28.36775,20.324,17.07725,15.214,13.841,12.6715,12.63,11.819,10.75975,11.461,12.00475,13.01925,15.139,17.85,18.7595,19.877,21.81225,23.542,26.965,31.23875,33.32325,35.46325,35.9945,37.39325,28.855,20.95925,16.90475,14.31675,12.6965,11.96525,11.448,10.93,11.06975,11.5115,11.79875,12.527,13.511,15.90675,17.80225,20.0945,21.56025,23.79625,25.6365,26.75375,28.34675,29.7475,32.43125,34.05475,29.81025,22.32775,18.57775,15.13175,14.0105,13.27875,12.972,13.334,13.00075,13.57175,14.34525,16.0025,17.94625,21.0895,26.2545,32.13525,36.8455,40.5465,43.768,44.97625,47.7965,49.3575,50.854,26.6485,13.9505,11.09425,9.58425,9.2825,8.51875,8.223,8.77675,8.28225,8.53525,8.53775,8.716,8.98375,9.69025,11.05075,13.00875,14.34675,14.77875,15.2935,15.702,15.9135,16.1675,15.7185,16.64,17.03775,15.10775,12.51375,11.48475,11.08825,9.8025,8.797,9.105,8.94575,8.7215,9.791,10.2355,11.06375,12.395)
Open.RH<-c(24.99425,20.05075,16.381,14.30525,11.4015,9.5495,9.23375,9.376,9.7155,10.7105,13.01925,16.7705,18.62275,19.23925,19.52175,21.1405,23.24375,23.47425,25.148,26.86425,31.04025,34.6725,34.6455,23.7415,19.58,17.106,15.23875,13.31275,11.90175,10.61025,9.42675,9.66275,10.2215,11.5215,14.6875,17.9925,19.10425,20.8955,22.6085,24.74625,28.54025,33.47,35.92175,38.2615,39.15775,40.7035,35.95025,24.609,18.86375,15.52575,13.71975,12.20325,10.64875,9.7375,9.593,9.84425,10.306,11.2635,12.92225,15.86125,18.30475,20.73275,22.16675,25.09175,26.93025,28.1775,30.10575,31.664,34.68275,36.48975,34.6105,25.68225,20.702,16.26925,14.697,13.16625,12.06625,11.9145,11.55075,11.905,12.48275,14.927,17.51725,20.97775,26.7505,33.01475,38.1075,42.9545,46.14525,48.1385,51.01225,53.05425,54.96575,26.891,14.81325,11.5285,9.762,9.316,8.4025,7.8575,7.986,7.39225,7.37425,7.3,7.5735,8.05875,9.06,10.632,13.1695,14.12975,14.60075,15.1495,15.665,15.77775,16.05875,15.548,16.515,17.00925,16.65325,13.402,11.97175,11.32825,10.0415,8.8695,8.44225,7.906,7.58575,8.19125,8.7505,9.91,11.78725)
Time <- seq(1,131,1)


par(mfrow=c(1,2))
par(mar=c(4.5,4.5,.5,.5))
plot(Time,Shrub.temp, type="n", xlab="Duration of Study (hours)", ylab="Temperature (CÂ°)", cex.axis=1.5, cex.lab=1.8)
lines(Time,Shrub.temp, lwd=3)
lines(Time,Open.temp, lwd=3, col="Grey70")


par(mar=c(4.5,4.5,.5,.5))
plot(Time,Shrub.RH, type="n", xlab="Duration of Study (hours)", ylab="Relative Humidity (%)", cex.axis=1.5, cex.lab=1.8, ylim=c(7,55))
lines(Time,Shrub.RH, lwd=3)
lines(Time,Open.RH, lwd=3, col="Grey70")

t.test(Shrub.temp,Open.temp)
t.test(Shrub.RH,Open.RH)
